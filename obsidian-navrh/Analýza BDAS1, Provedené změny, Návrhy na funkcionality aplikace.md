it

| Požadavek                                                       | Řešení                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |     |
| --------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --- |
| 10 tabulek včetně 2 číselníků                                   | Uživatelé<br>- e-mail<br>- hash hesla<br>**- obrázek \[fk]**<br>**- adresa \[fk]**<br>**- oprávnění \[fk]**<br>Oprávnění (číselník)<br>- název<br>- číselná úroveň oprávnění \<0-3><br>Květiny<br>- název<br>**- druh_květiny \[fk]**<br>**- obrázek \[fk]**<br>- cena<br>Košíky<br>- datum vytvoření<br>**- stav objednávky \[fk]**<br>- celková cena<br>+ m:n košíky+květiny<br>StavyObjednávek (číselník)<br>- název<br>Adresy<br>- ulice<br>- čp<br>- psč<br>- město<br>Kategorie (napojená sama na sebe, podporuje hierarchii)<br>- název<br>**- druh květiny \[fk]**<br>Dotazy<br>- datum podání<br>- text<br>- odpověď<br>Obrázky<br>- data<br>- název souboru<br>ArchivUživatelů<br>- e-mail - kopie<br>- adresa - kopie<br>- oprávnění - kopie<br>ArchivObjednávek (obsahuje objednávky smazaných uživatelských účtů)<br>**- archivovaný uživatel \[fk]**<br>- datum<br>- stav<br>- cena<br>+ m:n archivované květiny:archivované objednávky (+ atribut počet)<br>ArchivKvětin<br>- název - kopie<br>- druh květiny - kopie<br>- cena<br>HistorieObjednávek (obsahuje objednávky existujících <br>uživatelských účtů)<br>**- uživatel \[fk]**<br>- datum<br>- stav<br>- cena<br>+ m:n archivované květiny:objednávky |     |
| 4 úrovně oprávnění                                              | 1. Neregistrovaný uživatel - může prohlížet a zanechat dotaz<br>2. Uživatel - může nakupovat a zanechávat recenze<br>3. Zaměstnanec - může měnit obsah eshopu a stav objednávek uživatelů<br>4. Administrátor - může dělat všechno, emuluje jakéhokoliv uživatele                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |     |
| 3 pohledy                                                       | 1. Výpis produktů na hlavní stránce eshopu - podle hodnocení<br>2. Výpis uživatelů pro admina v dashboardu s dlouhodobou neaktivitou (2 roky) - pro účel archivování nebo smazání (=v případě žádné objednávky vytvořené tímto uživatelem)<br>3. **TODO**<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |     |
| 3 funkce                                                        | 1. Vygenerování silného, náhodně generovaného hesla (minimum 12 znaků,  1 velké písmeno, 1 symbol, 3 číslice)<br>2. Zjištění nároku na slevu podle počtu předchozích objednávek<br>3. **TODO**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |     |
| 4 procedury                                                     | 1. Aktualizace hesla uživatele<br>2. Podání objednávky <br>- vygeneruje datum podání<br>- uvede do stavu čeká na zaplacení<br>- vypočítá slevu na základě počtu předchozích objednávek - každá pátá objednávka má slevu 10%<br>3. Nalezení všech květin, které jsou podřízeny zadané kategorii (vrací kurzor všech nalezených květin v OUT parametru)<br>- využívá hierarchický dotaz<br>4. Smazání všech nezodpovězených dotazů starších než hodnota ve vstupním parametru                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |     |
| 3 formuláře                                                     | 1. Registrace uživatele<br>2. Dashboard produktů pro zaměstnance<br>3. Dotazy od neregistrovaných uživatelů                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |     |
| 2 triggery                                                      | 1. Při změně ceny květiny v eshopu se původní záznam uloží do tabulky ArchivKvětiny a aktualizují se ceny všech košíků obsahující danou květinu, které nejsou doposud odeslané objednávky<br>2. Pokud si uživatel zruší účet, je smazán, případně pokud má pod svým účtem dokončené objednávky, jsou archivovány                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |     |
| Implicitní kurzor                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |     |
| Explicitní kurzor                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |     |
| Logování historie tabulky(ek) skrz triggery                     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |     |
| Implementace transakcí nad procedurami upravující obsah tabulek | Transakce realizovány v každé proceduře která upravuje obsah tabulek<br>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |     |
| Procedurální pravidla                                           | 1. Právě jeden registrovaný uživatel může vytvářet objednávku<br>2. Odpovídat na dotazy smí pouze uživatel s oprávněním zaměstnanec nebo admin<br>3. Každý údaj o adrese nesmí být neúplný                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |     |
| Strukturální pravidla                                           | 1. Uživatel může zastávat právě jednu roli v každou danou chvíli<br>2. Součástí objednávky může být pouze jeden uživatel<br>3. Heslo uživatele je v databázi uloženo jako SHA-256 hash s náhodně generovanou solí při každém vytvoření nového hesla                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |     |
| Integritní omezenení                                            | 1. Každá entita má atribut ID jako primární klíč<br>2. Hodnota atributu uroven entity Oprávnění má hodnoty pouze 0-3<br>3. Datum podání objednávky nemůže být dřívější než aktuální datum<br>4. Cena květiny nemůže být menší než 0 ani menší než 99999999.99<br>5. Cena objednávky nemůže být menší než 0 ani větší než 9999999999.99                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |     |
|                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |     |
